<p id="notice"><%= notice %></p>

<p>
  <strong>Category:</strong>
  <%= @item.category %>
</p>

<p>
  <strong>Name:</strong>
  <%= @item.name %>
</p>

<p>
  <strong>User:</strong>
  <%= @item.user_id %>
</p>

<p>
  <strong>Date added:</strong>
  <%= @item.created_at %>
</p>

<p>
  <strong>Description:</strong>
  <%= @item.description %>
</p>

<% if !@item.images.empty? %>
  <% @item.images.each do |image| %>
    <%= image_tag(image, style: 'height:100px;width:auto;') %>
  <% end %>
<% end %>

<% if @item.trade_established %>
  <p>This item has been traded! You came too late lah.</p>
  <p>
    It was traded with
    <%= link_to "\"#{@traded_item.name}\"", @traded_item %>
  </p>
  
<% else %>
  <% if logged_in? %>
    <% if @item.user_id == current_user.id %>
      <p>
        <strong> Other people want to trade <%=@item.name%> with :</strong>
          <table>
            <thead>
              <tr>
                <th>Category</th>
                <th>Name</th>
                <th>Date added</th>
                <th colspan="3"></th>
              </tr>
            </thead>
            <tbody>
              <tbody>
              <% @item.bid_by.each do |item| %>
                <tr>
                  <td><%= item.category %></td>
                  <td><%= item.name %></td>
                  <td><%= item.created_at %></td>
                  <td><%= link_to 'Show', item %></td>
                  <!--
                  <td><%= link_to 'Trade', add_trade_item_path(@item, :bid_id => item.id), method: :post  %></td>
                  -->
                </tr>
              <% end %>
            </tbody>

            </tbody>
          </table>
      </p>
    <% else %>
      <p>
        <strong> Select items you want to trade for <%=@item.name%> :</strong>
          <table>
            <thead>
              <tr>
                <th>Category</th>
                <th>Name</th>
                <th>Date added</th>
                <th colspan="3"></th>
              </tr>
            </thead>
            <tbody>
              <% current_user.items.each do |item| %>
                <tr>
                  <td><%= item.category %></td>
                  <td><%= item.name %></td>
                  <td><%= item.created_at %></td>
                  <td><%= link_to 'Show', item %></td>
                  <% if !@item.bid_by.include?(item) %>
                    <td><%= link_to 'Trade', add_trade_item_path(@item, :bid_id => item.id), method: :post  %></td>
                  <% else %>
                    <td><%= link_to 'Cancel', cancel_bid_item_path(@item, :bid_id => item.id), method: :post %></td>
                  <% end %>
                </tr>
              <% end %>
            </tbody>
          </table>
      </p>
    <% end %>
  <% end %> 
<% end %>
=======

<% if logged_in? && @item.user_id == current_user.id %>
  <%= link_to 'Edit', edit_item_path(@item) %> |
<% end %> 
<%= link_to 'Back', session[:return_to] %>
